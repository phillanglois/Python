
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Sous-programme et affectation – aspects avancés &#8212; Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Les entrées-sorties (E/S) : aspects avancés" href="9-ES-avancees.html" />
    <link rel="prev" title="5. Les types composés" href="5-types_composes.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/python.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../bonjour.html">
                    Bienvenu en Prog Python!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  COURS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0-synthese.html">
   1. Synthèse introductive à Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1-fonctions.html">
   2. Fonctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2-boucles-avancees.html">
   3. Boucles, tableaux et fonctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-ES-fichiers.html">
   4. Entrées-sorties simples avec des fichiers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5-types_composes.html">
   5. Les types composés
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Sous-programme et affectation – aspects avancés
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9-ES-avancees.html">
   7. Les entrées-sorties (E/S) : aspects avancés
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-modules-utiles.html">
   8. Modules utiles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a1-booleens.html">
   9. Annexe : les booléens en python (&gt;3.6)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a2-ndarray.html">
   10. Les ‘ndarray’ : de vrais tableaux en python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a3-exceptions.html">
   11. Exceptions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TP
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tp/0-installation.html">
   1. Préparer son ordinateur et travailler avec Python et JupyterLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tp/1-bases.html">
   2. Feuille 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tp/2-knn.html">
   3. Feuille 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tp/3-env-convexe.html">
   4. Feuille 3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Compléments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pdf/memento.html">
   1. Memento
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/phillanglois/Python/main?urlpath=tree/chps2022/cm/7-fonctions-avancees.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/phillanglois/Python/issues/new?title=Issue%20on%20page%20%2Fcm/7-fonctions-avancees.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/cm/7-fonctions-avancees.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#le-passage-des-parametres-un-probleme-generique">
   6.1. Le passage des paramètres : un problème générique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comment-est-transmis-un-parametre-effectif">
     6.1.1. Comment est transmis un paramètre effectif ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deux-modes-materiels-de-passage-des-parametres">
     6.1.2. Deux modes
     <em>
      matériels
     </em>
     de passage des paramètres
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trois-modes-logiques-de-passage-des-parametres">
     6.1.3. Trois modes
     <em>
      logiques
     </em>
     de passage des paramètres
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#et-pour-python">
   6.2. Et pour python ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#star-variable-et-affection-aspects-avances">
   6.3. (
   <span class="math notranslate nohighlight">
    \(\star\)
   </span>
   ) Variable et affection : aspects avancés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notions-importantes">
     6.3.1. Notions importantes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variable-valeur-espace-de-stockage-adresse-en-memoire-reference">
       Variable, valeur, espace de stockage, adresse en mémoire, référence
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#affectation-et-evaluation">
       Affectation et évaluation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#declaration-vs-affectation">
       Déclaration
       <em>
        vs.
       </em>
       affectation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-et-affectation-en-python">
     6.3.2. Variables et affectation en python
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variables-en-python-mutable-ou-non-mutable">
       Variables en python : mutable ou non mutable ?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dupliquer-des-valeurs-par-reference-mutable-vs-non-mutable">
       Dupliquer des valeurs par référence :  mutable
       <em>
        vs.
       </em>
       non mutable
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#approfondissons-par-introspection">
     6.3.3. Approfondissons par
     <em>
      introspection
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#les-fonctions-type-et-id">
       Les fonctions
       <code class="docutils literal notranslate">
        <span class="pre">
         type(
        </span>
        <span class="pre">
         )
        </span>
       </code>
       et
       <code class="docutils literal notranslate">
        <span class="pre">
         id(
        </span>
        <span class="pre">
         )
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#introspection-de-l-affectation">
       Introspection de l’affectation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#affectation-en-python-complements">
     6.3.4. Affectation en python : compléments
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#modification-partielle-vs-modification-complete-d-un-mutable">
       Modification partielle
       <em>
        vs.
       </em>
       modification complète d’un mutable
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comment-dupliquer-re-copier-un-objet-mutable-et-obtenir-2-objets-differents-en-memoire">
       Comment dupliquer (re-copier) un objet mutable et obtenir 2 objets différents en mémoire ?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#des-subtilites-pour-x-1-vs-x-x-1">
       Des subtilités pour
       <code class="docutils literal notranslate">
        <span class="pre">
         x
        </span>
        <span class="pre">
         +=
        </span>
        <span class="pre">
         1
        </span>
       </code>
       <em>
        vs.
       </em>
       <code class="docutils literal notranslate">
        <span class="pre">
         x
        </span>
        <span class="pre">
         =
        </span>
        <span class="pre">
         x
        </span>
        <span class="pre">
         +
        </span>
        <span class="pre">
         1
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#star-fonctions-aspects-avances">
   6.4. (
   <span class="math notranslate nohighlight">
    \(\star\)
   </span>
   ) Fonctions : aspects avancés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#le-parametre-est-de-type-non-mutable">
     6.4.1. Le paramètre est de type non-mutable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#le-parametre-de-type-mutable">
     6.4.2. Le paramètre de type mutable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optionnel-avoir-les-id-claires">
     6.4.3. (Optionnel) Avoir les
     <code class="docutils literal notranslate">
      <span class="pre">
       id
      </span>
     </code>
     claires !
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utilisons-les-id-avec-les-mutables">
       Utilisons les
       <code class="docutils literal notranslate">
        <span class="pre">
         id()
        </span>
       </code>
       avec les mutables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utilisons-les-id-avec-les-non-mutables">
       Utilisons les
       <code class="docutils literal notranslate">
        <span class="pre">
         id()
        </span>
       </code>
       avec les non mutables
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#les-fonctions-en-python-derniers-complements-faciles">
   6.5. Les fonctions en python : derniers compléments faciles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arguments-nommes">
     6.5.1. Arguments nommés
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#argument-avec-valeur-par-defaut">
     6.5.2. Argument avec valeur par défaut
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ce-qu-il-reste-a-voir-sur-les-fonctions-en-python">
     6.5.3. Ce qu’il reste à voir sur les fonctions en python
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synthese">
   6.6. Synthèse
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avoir-les-idees-claires">
     6.6.1. Avoir les idées claires
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#savoir-faire-en-python">
     6.6.2. Savoir-faire en python
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Sous-programme et affectation – aspects avancés</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#le-passage-des-parametres-un-probleme-generique">
   6.1. Le passage des paramètres : un problème générique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comment-est-transmis-un-parametre-effectif">
     6.1.1. Comment est transmis un paramètre effectif ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deux-modes-materiels-de-passage-des-parametres">
     6.1.2. Deux modes
     <em>
      matériels
     </em>
     de passage des paramètres
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trois-modes-logiques-de-passage-des-parametres">
     6.1.3. Trois modes
     <em>
      logiques
     </em>
     de passage des paramètres
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#et-pour-python">
   6.2. Et pour python ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#star-variable-et-affection-aspects-avances">
   6.3. (
   <span class="math notranslate nohighlight">
    \(\star\)
   </span>
   ) Variable et affection : aspects avancés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notions-importantes">
     6.3.1. Notions importantes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variable-valeur-espace-de-stockage-adresse-en-memoire-reference">
       Variable, valeur, espace de stockage, adresse en mémoire, référence
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#affectation-et-evaluation">
       Affectation et évaluation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#declaration-vs-affectation">
       Déclaration
       <em>
        vs.
       </em>
       affectation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-et-affectation-en-python">
     6.3.2. Variables et affectation en python
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variables-en-python-mutable-ou-non-mutable">
       Variables en python : mutable ou non mutable ?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dupliquer-des-valeurs-par-reference-mutable-vs-non-mutable">
       Dupliquer des valeurs par référence :  mutable
       <em>
        vs.
       </em>
       non mutable
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#approfondissons-par-introspection">
     6.3.3. Approfondissons par
     <em>
      introspection
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#les-fonctions-type-et-id">
       Les fonctions
       <code class="docutils literal notranslate">
        <span class="pre">
         type(
        </span>
        <span class="pre">
         )
        </span>
       </code>
       et
       <code class="docutils literal notranslate">
        <span class="pre">
         id(
        </span>
        <span class="pre">
         )
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#introspection-de-l-affectation">
       Introspection de l’affectation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#affectation-en-python-complements">
     6.3.4. Affectation en python : compléments
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#modification-partielle-vs-modification-complete-d-un-mutable">
       Modification partielle
       <em>
        vs.
       </em>
       modification complète d’un mutable
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comment-dupliquer-re-copier-un-objet-mutable-et-obtenir-2-objets-differents-en-memoire">
       Comment dupliquer (re-copier) un objet mutable et obtenir 2 objets différents en mémoire ?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#des-subtilites-pour-x-1-vs-x-x-1">
       Des subtilités pour
       <code class="docutils literal notranslate">
        <span class="pre">
         x
        </span>
        <span class="pre">
         +=
        </span>
        <span class="pre">
         1
        </span>
       </code>
       <em>
        vs.
       </em>
       <code class="docutils literal notranslate">
        <span class="pre">
         x
        </span>
        <span class="pre">
         =
        </span>
        <span class="pre">
         x
        </span>
        <span class="pre">
         +
        </span>
        <span class="pre">
         1
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#star-fonctions-aspects-avances">
   6.4. (
   <span class="math notranslate nohighlight">
    \(\star\)
   </span>
   ) Fonctions : aspects avancés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#le-parametre-est-de-type-non-mutable">
     6.4.1. Le paramètre est de type non-mutable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#le-parametre-de-type-mutable">
     6.4.2. Le paramètre de type mutable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optionnel-avoir-les-id-claires">
     6.4.3. (Optionnel) Avoir les
     <code class="docutils literal notranslate">
      <span class="pre">
       id
      </span>
     </code>
     claires !
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utilisons-les-id-avec-les-mutables">
       Utilisons les
       <code class="docutils literal notranslate">
        <span class="pre">
         id()
        </span>
       </code>
       avec les mutables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utilisons-les-id-avec-les-non-mutables">
       Utilisons les
       <code class="docutils literal notranslate">
        <span class="pre">
         id()
        </span>
       </code>
       avec les non mutables
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#les-fonctions-en-python-derniers-complements-faciles">
   6.5. Les fonctions en python : derniers compléments faciles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arguments-nommes">
     6.5.1. Arguments nommés
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#argument-avec-valeur-par-defaut">
     6.5.2. Argument avec valeur par défaut
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ce-qu-il-reste-a-voir-sur-les-fonctions-en-python">
     6.5.3. Ce qu’il reste à voir sur les fonctions en python
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synthese">
   6.6. Synthèse
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avoir-les-idees-claires">
     6.6.1. Avoir les idées claires
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#savoir-faire-en-python">
     6.6.2. Savoir-faire en python
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="sous-programme-et-affectation-aspects-avances">
<span id="ch-fonctionsavancees"></span><h1><span class="section-number">6. </span>Sous-programme et affectation – aspects avancés<a class="headerlink" href="#sous-programme-et-affectation-aspects-avances" title="Permalink to this headline">#</a></h1>
<p>version 2021, PhL (v2.2)</p>
<p>Nous abordons maintenant les aspects des fonctions qui dépendent des langages de programmation. Nous insistons surtout sur les choix de python3.</p>
<p><strong>Rappel.</strong>  Le terme <em>paramètre effectif</em>, et son compagnon <em>paramètre formel</em>, sont des termes “langage-indépendant”. En python, le terme <em>argument</em> est utilisé à la place du terme <em>paramètre effectif</em>. Ainsi argument et paramètre effectif sont des synonymes, et seront utilisés comme tel dans ce qui suit.</p>
<section id="le-passage-des-parametres-un-probleme-generique">
<h2><span class="section-number">6.1. </span>Le passage des paramètres : un problème générique<a class="headerlink" href="#le-passage-des-parametres-un-probleme-generique" title="Permalink to this headline">#</a></h2>
<p>Le corps de la fonction ne connaît que les paramètres formels.<br />
L’appel de la fonction définit les paramètres effectifs .</p>
<ul class="simple">
<li><p>Comment le paramètre effectif devient-il connu par la fonction appelée ?</p></li>
<li><p>Qu’est-ce qui est connu dans l’appel, en particulier <em>lorsque le paramètre effectif est une variable</em> ?</p>
<ul>
<li><p><em>la valeur</em> du paramètre effectif  ?</p></li>
<li><p><em>la variable</em> paramètre effectif  ?</p></li>
</ul>
</li>
</ul>
<p>Se sont les questions du passage de paramètres appelant-&gt;appelé</p>
<section id="comment-est-transmis-un-parametre-effectif">
<h3><span class="section-number">6.1.1. </span>Comment est transmis un paramètre effectif ?<a class="headerlink" href="#comment-est-transmis-un-parametre-effectif" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Si c’est une constante :  <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(3)</span></code><br />
OK : la valeur constante est connue et utilisée dans l’appel</p></li>
<li><p>Si c’est une variable : <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> connaît la valeur de <code class="docutils literal notranslate"><span class="pre">x</span></code> et seulement sa valeur ?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> connaît la variable <code class="docutils literal notranslate"><span class="pre">x</span></code>, ce qui permet de <em>lire</em> sa valeur et aussi de <em>la modifier</em> a priori ?</p></li>
</ul>
</li>
<li><p>Cette distinction s’étend aux paramètres (formels et effectifs) de type composé comme les tableaux, les listes, les chaînes de caractères, les enregistrements (ou structures) …</p></li>
</ul>
</section>
<section id="deux-modes-materiels-de-passage-des-parametres">
<h3><span class="section-number">6.1.2. </span>Deux modes <em>matériels</em> de passage des paramètres<a class="headerlink" href="#deux-modes-materiels-de-passage-des-parametres" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p><strong>passage par valeur</strong> ou <strong>copie</strong> :  seules les <em>valeurs</em> des paramètres effectifs sont connus par la fonction.<br />
Ainsi, <strong>les paramètres effectifs</strong>, qui sont des variables dans le programme appelant, <strong>ne sont pas modifiés</strong>. Bien sûr, ce n’est pas le cas du/des paramètre/s de sortie).</p></li>
<li><p><strong>passage par adresse</strong> ou <strong>référence</strong> : les <em>adresses</em> des paramètres effectifs sont connues et sont manipulées par la fonction.<br />
Ces paramètres effectifs sont donc <em>les</em> variables de l’appelant – et aussi de l’appel.<br />
La fonction peut donc <strong>modifier les variables de l’appelant <em>indépendamment</em> du <code class="docutils literal notranslate"><span class="pre">return</span></code></strong>.</p></li>
</ol>
<div class="alert alert-block alert-info">
Pros/cons : la copie de la valeur d'une "grosse" variable coûte plus cher que la copie de son adresse (c'est un `int`)  
</div>
<p>Les modes appliqués dépendent :</p>
<ul class="simple">
<li><p>des langages de programmation</p></li>
<li><p>du <em>type</em> des paramètres</p></li>
</ul>
<p>C-a-d. que les 2 modes peuvent coexister dans un même langage.</p>
</section>
<section id="trois-modes-logiques-de-passage-des-parametres">
<h3><span class="section-number">6.1.3. </span>Trois modes <em>logiques</em> de passage des paramètres<a class="headerlink" href="#trois-modes-logiques-de-passage-des-parametres" title="Permalink to this headline">#</a></h3>
<p>Certains langages (Ada par exemple) se sont dégagés des aspects matériels pour définir des modes <em>logiques</em>.<br />
Bien sûr, l’implantation de ces modes logiques repose sur l’une ou l’autre des 2 modes physiques.</p>
<ol class="simple">
<li><p>mode <code class="docutils literal notranslate"><span class="pre">in</span></code> : le paramètre est uniquement utilisé en lecture, c-a-d. seule la transmission de sa valeur est nécessaire</p></li>
<li><p>mode <code class="docutils literal notranslate"><span class="pre">in-out</span></code> : le paramètre est utilisé en lecture et en écriture, ici encore son adresse est nécessaire dans l’appel</p></li>
<li><p>mode <code class="docutils literal notranslate"><span class="pre">out</span></code> : le paramètre est uniquement utilisé en écriture, c-a-d. sa valeur est (formellement) inconnue dans la fonction ; cette dernière détermine sa valeur et la transmet (par valeur ou par adresse) à l’appelant.</p></li>
</ol>
<p>Ces modes sont facilement vérifiables lors de la compilation.
Le mode <code class="docutils literal notranslate"><span class="pre">in</span></code> correspond aux paramètres d’entrée d’une fonction.
Le mode <code class="docutils literal notranslate"><span class="pre">out</span></code> correspond à la valeur retournée par une fonction.
le mode <code class="docutils literal notranslate"><span class="pre">in-out</span></code> correspond aux paramètres d’une <em>procédure</em> : les paramètres effectifs existent avant l’appel, celui-ci les modifient et ils subsistent au retour dans l’appelant.</p>
</section>
</section>
<section id="et-pour-python">
<h2><span class="section-number">6.2. </span>Et pour python ?<a class="headerlink" href="#et-pour-python" title="Permalink to this headline">#</a></h2>
<p>Le <a class="reference external" href="https://docs.python.org/fr/3/tutorial/controlflow.html#id2">tutoriel python.org</a> dit :</p>
<blockquote>
<div><p>Les paramètres effectifs (arguments) d’une fonction sont introduits dans la table de symboles locale de la fonction appelée lorsqu’elle est appelée ; par conséquent, <strong>les passages de paramètres</strong> se font par valeur, la valeur étant toujours une <strong>référence à un objet</strong>, et non la valeur de l’objet lui-même.</p>
</div></blockquote>
<p>Rassurez-vous : cette définition est difficile à comprendre <em>en l’état</em>.
La suite de ce chapitre va permettre de mieux voir de quoi il s’agit.</p>
<p>Mentionnons qu’<strong>en python</strong>, le passage de paramètres est en fait similaire à celui de l’<em>affectation</em>.
Il nous faut donc détailler ce qu’il y a “derrière” l’affectation en python.
C’est l’objet de la <a class="reference external" href="#revisiter_les_variables_et_l%27affectation">section suivante</a>.</p>
<p>Cependant indiquons dès maintenant <strong>ce qu’il faut retenir</strong> concernant le passage de paramètres.</p>
<div class="alert alert-block alert-info">
<p>Le passage des paramètres ( et de l’affectation ) en python <b>dépend</b> du caractère <b>mutable</b> ou <b>non mutable de l’argument</b> (i.e. paramètre effectif) concerné.</p>
</div><div class="alert alert-block alert-info">
<p>Un paramètre effectif <b>non mutable</b> est traité comme une <b>variable locale</b> à la fonction.</p>
<ul>
<li> Ainsi la variable argument est connue dans la fonction mais elle <b>n'est pas modifiée dans l'appelant</b> par le traitement de la fonction
</li>
    <li> Il n'y a <b>pas d'effet de bord</b> de la fonction sur un paramètre effectif <b>non mutable</b>. 
</li>
    </ul>
</div>
<div class="alert alert-block alert-info">
<p>Un paramètre effectif <b>mutable</b> est “entièrement et directement accessible” par la fonction, comme une variable globale de l’appelant.</p>
<ul>    
<li>  Ainsi une variable-argument mutable <b>pourra être modifiée dans l'appelant</b> par le traitement de la fonction appelée.</li>
<li> Un paramètre effectif <b>mutable d'une fonction est susceptible d'un <em>effet de bord</em></b> suite à l'appel de la fonction. </li>
</ul>    
</div><p>Dans ce dernier cas (argument mutable), une variable-argument peut être modifiée partiellement ou complètement. Par exemple, une liste peut-être allongée, écourtée, concaténée, ses valeurs peuvent être modifiées globalement ; ce qui sera différent de modifications ponctuelles de certaines de ses valeurs.</p>
<div class="alert alert-block alert-info">
<ul> 
<li>Une <b>modification partielle</b> d'une variable-argument mutable et <em>non concernée par le `return`</em>  provoquera un <b>effet de bord</b> malvenu dans l'appelant.</li>
<li> Une modification complète de cet argument mutable n'aura pas un tel effet.</li>
</ul>    
</div>   <p>En pratique, il est très fortement conseillé d’éviter tout effet de bord d’une fonction <em>qui n’est pas une procédure</em>.
<strong>Il appartient au programmeur d’être attentif au caractère mutable ou non mutable des paramètres des appels de fonctions</strong> – surtout dans le contexte de typage dynamique de python : rappelons que les annotations de type des paramètres ne sont que des indications pour le lecteur ou des outils spécialisés mais sont ignorées de l’interpréteur python.</p>
</section>
<section id="star-variable-et-affection-aspects-avances">
<h2><span class="section-number">6.3. </span>(<span class="math notranslate nohighlight">\(\star\)</span>) Variable et affection : aspects avancés<a class="headerlink" href="#star-variable-et-affection-aspects-avances" title="Permalink to this headline">#</a></h2>
<div class="alert alert-block alert-success">
    Cette section relève de <b>l'objectif 20</b>
</div>
<p>Commençons par revenir sur les notions de <strong>variable</strong> et d’<strong>affectation</strong>.
Puis comment ces notions existent en python.</p>
<section id="notions-importantes">
<h3><span class="section-number">6.3.1. </span>Notions importantes<a class="headerlink" href="#notions-importantes" title="Permalink to this headline">#</a></h3>
<section id="variable-valeur-espace-de-stockage-adresse-en-memoire-reference">
<h4>Variable, valeur, espace de stockage, adresse en mémoire, référence<a class="headerlink" href="#variable-valeur-espace-de-stockage-adresse-en-memoire-reference" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>une <em>variable</em> permet d’accéder, en lecture ou en écriture, à une <em>valeur</em> qui est stockée en mémoire</p>
<ul>
<li><p>une <em>variable</em> est définie par son <em>identifiant</em> : son nom de variable : <code class="docutils literal notranslate"><span class="pre">n,</span> <span class="pre">t,</span> <span class="pre">ma_liste,</span> <span class="pre">...</span></code></p></li>
</ul>
</li>
<li><p>une <em>valeur</em> est stockée à un emplacement en mémoire aussi appelé <em>espace de stockage</em></p>
<ul>
<li><p>il est unique et test repéré par son <em>adresse</em></p></li>
<li><p>une adresse est (similaire à) un <code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p>la taille de l’espace mémoire dépend du type des valeurs à stocker : <code class="docutils literal notranslate"><span class="pre">int</span></code> (par exemple 32 bits) vs <code class="docutils literal notranslate"><span class="pre">float</span></code>(64 bits) vs. une <code class="docutils literal notranslate"><span class="pre">list</span></code> de <code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
</ul>
</li>
</ul>
<p>Ainsi l’identifiant d’une variable peut-être vue comme un symbole associé à un espace de stockage.<br />
L’identifiant de la variable est ainsi <strong>une référence</strong> à un espace de stockage.</p>
<p>Attention :</p>
<ul class="simple">
<li><p>la difficulté de la notion de variable vient du fait que ce terme désigne, selon les cas, la valeur stockée en mémoire ou l’espace de stockage lui-même.</p></li>
<li><p>la notion de <em>référence</em> prend des sens différemment subtils selon les langage de programmation.</p></li>
</ul>
</section>
<section id="affectation-et-evaluation">
<h4>Affectation et évaluation<a class="headerlink" href="#affectation-et-evaluation" title="Permalink to this headline">#</a></h4>
<p>L’<em>affectation d’une valeur à une variable</em> correspond à une modification de l’espace de stockage associé à la variable.</p>
<ul class="simple">
<li><p>La <em>valeur</em> affectée est le résultat de l’<em>évaluation</em> du membre du droite de l’affectation.</p></li>
<li><p>Ce membre de droite peut être :</p>
<ul>
<li><p>une valeur d’initialisation : <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">3</span></code> ou <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">[1,2,3]</span></code>,</p></li>
<li><p>une variable : <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code>,</p></li>
<li><p>une expression : <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">+</span> <span class="pre">5</span></code>,</p></li>
<li><p>un appel de fonction <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">cos(alpha)</span></code></p></li>
<li><p>ou d’autres combinaisons plus compliquées.</p></li>
</ul>
</li>
</ul>
<p>Dans tous les cas, l’évaluation retourne <em>une valeur</em>.</p>
<p>Mais cette valeur peut prendre deux formes très différentes que nous introduisons avec l’exemple de l’affectation</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> où <code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> sont deux variables.</p>
</div></blockquote>
<p>L’association variable <code class="docutils literal notranslate"><span class="pre">x</span></code> &lt;-&gt; variable <code class="docutils literal notranslate"><span class="pre">y</span></code> peut être en effet réalisée de 2 façons :</p>
<ul class="simple">
<li><p>par <strong>copie</strong> : la variable <code class="docutils literal notranslate"><span class="pre">x</span></code> prend comme valeur <em>la valeur</em> de <code class="docutils literal notranslate"><span class="pre">y</span></code> (la répétition de “valeur” est voulue)</p>
<ul>
<li><p>la valeur de <code class="docutils literal notranslate"><span class="pre">y</span></code> est dupliquée à une nouvelle adresse mémoire</p></li>
<li><p>la valeur à cette nouvelle adresse est maintenant accessible par l’identifiant <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
</li>
<li><p>par <strong>référence</strong> : la variable <code class="docutils literal notranslate"><span class="pre">x</span></code> prend comme valeur <em>l’adresse de la valeur de <code class="docutils literal notranslate"><span class="pre">y</span></code></em> (emplacement mémoire où est stockée la valeur de <code class="docutils literal notranslate"><span class="pre">y</span></code>)</p>
<ul>
<li><p>la valeur de <code class="docutils literal notranslate"><span class="pre">y</span></code> n’est <em>pas dupliquée</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> référencent <em>le même endroit en mémoire.</em></p></li>
</ul>
</li>
</ul>
<p>Dans les 2 cas :</p>
<ul class="simple">
<li><p>la valeur de <code class="docutils literal notranslate"><span class="pre">x</span></code> avant l’affectation, si il y en avait une, est perdue.</p></li>
</ul>
</section>
<section id="declaration-vs-affectation">
<h4>Déclaration <em>vs.</em> affectation<a class="headerlink" href="#declaration-vs-affectation" title="Permalink to this headline">#</a></h4>
<p>Dans la plupart des langages de programmation <strong>mais pas en Python</strong>, une variable doit être déclarée <em>avant</em> d’être utilisée.</p>
<p>Typiquement, la déclaration d’une variable contient la définition de son identifiant, <em>de son type</em>, d’une valeur initiale (l’initialisation) et éventuellement d’autres propriétés diverses.</p>
<p>Une fois déclarée, la variable existe.
<em>Affecter une valeur à cette variable</em> est une des premières actions que l’on effectue avec cette variable.</p>
<p><strong>En python</strong> :</p>
<blockquote>
<div><p>Pas de déclaration<br />
Une variable est définie (elle commence à exister) par sa première affectation.<br />
Cette première affectation définit le type de cette variable et sa valeur (et donc son caractère mutable ou non mutable).</p>
</div></blockquote>
<p>Une variable python <em>est donc créée par l’affectation d’une valeur</em>.</p>
</section>
</section>
<section id="variables-et-affectation-en-python">
<h3><span class="section-number">6.3.2. </span>Variables et affectation en python<a class="headerlink" href="#variables-et-affectation-en-python" title="Permalink to this headline">#</a></h3>
<section id="variables-en-python-mutable-ou-non-mutable">
<h4>Variables en python : mutable ou non mutable ?<a class="headerlink" href="#variables-en-python-mutable-ou-non-mutable" title="Permalink to this headline">#</a></h4>
<p>On a écrit qu’une variable python est une référence.
Mais une référence à quoi ? A une valeur ? A une adresse de la mémoire ?</p>
<p>Les deux cas existent en python et dépendent du caractère mutable ou non mutable de la variable.</p>
<div class="alert alert-block alert-info">
<ul> 
<li>Une variable non mutable est une référence à une valeur.  </li>
<li>Une variable mutable est une référence à l'adresse d'un espace de stockage. </li>
</ul>
</div> 
<blockquote>
<div><p>python :</p>
<ul class="simple">
<li><p>les types non-mutables : <code class="docutils literal notranslate"><span class="pre">int,</span> <span class="pre">float,</span> <span class="pre">string,</span> <span class="pre">tuple</span> </code></p></li>
<li><p>les types mutables : <code class="docutils literal notranslate"><span class="pre">list,</span> <span class="pre">set,</span> <span class="pre">dict(ionnaire)</span></code></p></li>
</ul>
</div></blockquote>
<p><strong>pythontutor.</strong> Illustrons cette importante différence avec cet
<a class="reference external" href="http://pythontutor.com/visualize.html#code=x%20%3D%203%0At%20%3D%20%5B1,%202,%203%5D%0A&amp;cumulative=false&amp;curInstr=2&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false">exemple</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> est une variable non mutable (c’est un <code class="docutils literal notranslate"><span class="pre">int</span></code>) et son identifiant correspond bien à la valeur d’initialisation, ici <code class="docutils literal notranslate"><span class="pre">3</span></code>. <code class="docutils literal notranslate"><span class="pre">x</span></code> est bien une (référence à) une valeur : la valeur <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></li>
<li><p>En revanche, <code class="docutils literal notranslate"><span class="pre">t</span></code>  est une liste python qui représente le tableau 1D de longueur 3 initialisé par les valeurs entières ‘1, 2, 3’. <em>Une liste python est une variable mutable</em>. Ainsi, on voit que la variable <code class="docutils literal notranslate"><span class="pre">t</span></code> est représentée par une flèche qui désigne une (la) zone mémoire où sont stockés les 3 valeurs du tableau <code class="docutils literal notranslate"><span class="pre">t</span></code>.  <code class="docutils literal notranslate"><span class="pre">t</span></code> est encore une valeur mais cette fois, cette valeur est une adresse (vers les valeurs de la variable mutable).</p></li>
</ul>
<p>Cette différence va prendre tout son sens avec l’affectation (et le passage de paramètre pour les fonctions).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># à essayer aussi dans pythontutor</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;bonjour&quot;</span>
<span class="n">e0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># un tuple est non mutable</span>
<span class="n">l0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1"># une liste est mutable</span>


<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bonjour
</pre></div>
</div>
</div>
</div>
</section>
<section id="dupliquer-des-valeurs-par-reference-mutable-vs-non-mutable">
<h4>Dupliquer des valeurs par référence :  mutable <em>vs.</em> non mutable<a class="headerlink" href="#dupliquer-des-valeurs-par-reference-mutable-vs-non-mutable" title="Permalink to this headline">#</a></h4>
<div class="alert alert-block alert-info">
<p><strong>Cas mutable :</strong> l’affectation par référence <strong>ne duplique pas la valeur</strong>.</p>
</div><p>Ainsi si cette valeur est déjà associée à une autre variable (cas de l’affectation <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> où <code class="docutils literal notranslate"><span class="pre">y</span></code> a été initialisée précédemment) alors <code class="docutils literal notranslate"><span class="pre">x</span></code> <strong>et</strong> <code class="docutils literal notranslate"><span class="pre">y</span></code> référencent le même emplacement en mémoire.<br />
La modification ultérieure de l’une ou de l’autre des variables nécessite de lever l’ambiguïté suivante.</p>
<div class="alert alert-block alert-info">
<p><strong>Effet de bord :</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> est une variable introduite par l’affectation <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> où <code class="docutils literal notranslate"><span class="pre">y</span></code> est une autre variable pré-existante.</p>
<ul class="simple">
<li><p>Modifier <b>ultérieurement</b> <code class="docutils literal notranslate"><span class="pre">x</span></code>  a-t-il aussi un effet sur <code class="docutils literal notranslate"><span class="pre">y</span></code> ?</p></li>
<li><p>Modifier <b>ultérieurement</b> <code class="docutils literal notranslate"><span class="pre">y</span></code>  a-t-il aussi un effet sur <code class="docutils literal notranslate"><span class="pre">x</span></code> ?</p></li>
</ul>
</div><p>Un tel effet est appelé un <strong>effet de bord</strong> ; ce qui peut être choquant d’un point de vue algorithmique.</p>
<p>En python, il est clair maintenant que la réponse à cette question dépend du caractère <em>mutable</em> ou <em>non mutable</em> du type de la variable.</p>
<p><strong>Rmq.</strong> La fonction prédéfinie <code class="docutils literal notranslate"><span class="pre">id()</span></code> est définie au paragraphe suivant.  Elle retourne l’adresse “en mémoire” de son argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aff</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="p">:</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;affichage adapté</span>
<span class="sd">    Rmq : l&#39;annotation None pour v1 et v2 veut dire Any</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">CAS_VRAI</span> <span class="o">=</span> <span class="s2">&quot;emplacements mémoire identiques&quot;</span>
    <span class="n">CAS_FAUX</span> <span class="o">=</span> <span class="s2">&quot;emplacements mémoire différents&quot;</span>

    <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">v2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">CAS_VRAI</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">CAS_FAUX</span><span class="p">)</span>

<span class="c1"># les int sont non mutables</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c1"># gardons ce cas particulier pour plus tard</span>
<span class="c1">#x = 5</span>
<span class="c1">#aff(x, y)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># les strings sont non mutables</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;aa&quot;</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span>
<span class="n">aff</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s2">&quot;bb&quot;</span>
<span class="n">aff</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;ab&quot;</span>
<span class="n">aff</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span> 

<span class="c1"># les listes sont mutables</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span>
<span class="n">aff</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;je modifie complètement m :&quot;</span><span class="p">)</span>
<span class="n">aff</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;je recommence avec l = [1,1] et m = l &quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mais je modifie partiellement m sans penser à l :&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">aff</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 3 emplacements mémoire identiques
3 5 emplacements mémoire différents
6 5 emplacements mémoire différents

aa aa emplacements mémoire identiques
aa bb emplacements mémoire différents
ab bb emplacements mémoire différents

[1, 1] [1, 1] emplacements mémoire identiques
je modifie complètement m :
[1, 1] [2, 2] emplacements mémoire différents

je recommence avec l = [1,1] et m = l 
mais je modifie partiellement m sans penser à l :
[0, 1] [0, 1] emplacements mémoire identiques
</pre></div>
</div>
</div>
</div>
<p>Comme déjà évoqué, le dernier résultat (modification partielle de mutable) est assez surprenant.
Je vous laisse imaginer la recherche de bug …</p>
<div class="alert alert-block alert-danger">
<p>L’affectation python <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> avec des variables <b>mutables</b> <em>ne crée pas</em> un nouvel emplacement mémoire pour <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Elle créée <em>une nouvelle référence</em> pour <code class="docutils literal notranslate"><span class="pre">x</span></code> (ou met à jour une référence existante) <em>vers un emplacement qui existait précédemment</em> : celui de <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>Ainsi cet emplacement est accessible par plusieurs références – ici <code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> sont des références vers le <b>même emplacement mémoire</b>.</p>
</div><p>En pratique, l’environnement python connaît le nombre de références qui désignent le même emplacement mémoire.
Ce qui lui permet le cas échéant de récupérer les zones qui ne sont plus désignées (mécanisme de <em>garbage collector</em> ou <em>ramasse miettes</em> en français).</p>
</section>
</section>
<section id="approfondissons-par-introspection">
<h3><span class="section-number">6.3.3. </span>Approfondissons par <em>introspection</em><a class="headerlink" href="#approfondissons-par-introspection" title="Permalink to this headline">#</a></h3>
<p>Nous verrons plus tard que les “entités python” sont des <em>objets</em>.<br />
python fait partie des langages de programmation appelés <strong>langage objet</strong> ou <strong>langage orienté objet</strong>.<br />
Un <em>objet</em> est un ensemble d’<em>attributs</em> (des valeurs nommées) et de <em>méthodes</em> (des fonctions qui s’appliquent à <em>tout</em> ou <em>partie</em> de cet objet), cet ensemble étant accessible par un <em>identifiant</em> (le nom de l’objet).<br />
Nous verrons qu’en fait un objet est (très souvent) associé à une notion plus générale, la notion de <em>classe d’objets</em>.<br />
Une <em>classe</em> d’objets est un modèle d’objets et ainsi un objet d’une classe donnée est aussi appelé <em>une instance</em> de cette classe.</p>
<p><strong>Rmq.</strong> Pour l’instant, pas d’énorme différence entre objet et variable telle que présentée jusqu’à présent.</p>
<section id="les-fonctions-type-et-id">
<h4>Les fonctions  <code class="docutils literal notranslate"><span class="pre">type(</span> <span class="pre">)</span></code> et <code class="docutils literal notranslate"><span class="pre">id(</span> <span class="pre">)</span></code><a class="headerlink" href="#les-fonctions-type-et-id" title="Permalink to this headline">#</a></h4>
<p>Parmi les méthodes de tout objet python, certaines permettent <em>l’introspection</em>, c-a-d. permettent d’obtenir des informations sur l’objet et sur son état.</p>
<p>Nous allons présenter ici :</p>
<ul class="simple">
<li><p>les fonctions  <code class="docutils literal notranslate"><span class="pre">type()</span></code> et <code class="docutils literal notranslate"><span class="pre">id()</span></code> qui retournent, respectivement, le type et l’adresse (mémoire) unique  de l’argument.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.1</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 &lt;class &#39;int&#39;&gt; 140201721731376
1.1 &lt;class &#39;float&#39;&gt; 140201803264432
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0] &lt;class &#39;list&#39;&gt; 140201804603840
[1, 1] &lt;class &#39;list&#39;&gt; 140201804601344
140201721731344 140201721731344
</pre></div>
</div>
</div>
</div>
<p><strong>Autres fonctions d’introspection</strong></p>
<p>D’autres fonctions d’introspection très utiles existent. Essayez-les !</p>
<ul class="simple">
<li><p>la fonction <code class="docutils literal notranslate"><span class="pre">help()</span></code>  déjà connue</p></li>
<li><p>les fonctions  <code class="docutils literal notranslate"><span class="pre">locals()</span></code> et <code class="docutils literal notranslate"><span class="pre">globals()</span></code> qui retournent la liste des variables locales, resp. globales, au contexte de leur appel ;</p></li>
<li><p>la fonction <code class="docutils literal notranslate"><span class="pre">dir()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">locals</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="nb">globals</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on built-in function locals in module builtins:

locals()
    Return a dictionary containing the current scope&#39;s local variables.
    
    NOTE: Whether or not updates to this dictionary will affect name lookups in
    the local scope and vice-versa is *implementation dependent* and not
    covered by any backwards compatibility guarantees.

Help on built-in function globals in module builtins:

globals()
    Return the dictionary containing the current scope&#39;s global variables.
    
    NOTE: Updates to this dictionary *will* affect name lookups in the current
    global scope and vice-versa.

Help on built-in function dir in module builtins:

dir(...)
    dir([object]) -&gt; list of strings
    
    If called without an argument, return the names in the current scope.
    Else, return an alphabetized list of names comprising (some of) the attributes
    of the given object, and of attributes reachable from it.
    If the object supplies a method named __dir__, it will be used; otherwise
    the default dir() logic is used and returns:
      for a module object: the module&#39;s attributes.
      for a class object:  its attributes, and recursively the attributes
        of its bases.
      for any other object: its attributes, its class&#39;s attributes, and
        recursively the attributes of its class&#39;s base classes.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">locals</span><span class="p">()</span> <span class="o">==</span> <span class="nb">globals</span><span class="p">()</span>
<span class="c1">#print(locals())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#print(dir(a))</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#print(dir(l))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dir</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
</section>
<section id="introspection-de-l-affectation">
<h4>Introspection de l’affectation<a class="headerlink" href="#introspection-de-l-affectation" title="Permalink to this headline">#</a></h4>
<p>Dans les traitements suivants, retrouvons les comportements décrits précédemment.
Etonné ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># affectation de non-mutables</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a:&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b:&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b:&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># affectation de non-mutables</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;aagskjhdsqgf qkdhqhq &quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s:&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># affectation et modification de mutables</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">l</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a: 1 &lt;class &#39;int&#39;&gt; 140201721731376
b: 1 &lt;class &#39;int&#39;&gt; 140201721731376
b: 2 &lt;class &#39;int&#39;&gt; 140201721731408 

s: aagskjhdsqgf qkdhqhq  &lt;class &#39;str&#39;&gt; 140201804596048
s2 aagskjhdsqgf qkdhqhq  &lt;class &#39;str&#39;&gt; 140201804596048
s2 a &lt;class &#39;str&#39;&gt; 140201743294512 

[0, 0] &lt;class &#39;list&#39;&gt; 140201804591680
[0, 0] &lt;class &#39;list&#39;&gt; 140201804591680
[1, 0] &lt;class &#39;list&#39;&gt; 140201804592064
[0, 0] &lt;class &#39;list&#39;&gt; 140201804591680
[1, 1] &lt;class &#39;list&#39;&gt; 140201804582208
[0, 1] &lt;class &#39;list&#39;&gt; 140201804582208 
</pre></div>
</div>
</div>
</div>
<p><strong>Remarque.</strong>
Les premiers traitements (repris ici) :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># affectation de non-mutables</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;aagskjhdsqgf qkdhqhq &quot;</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>

<span class="c1"># affectation de mutables</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">l</span>
</pre></div>
</div>
</div>
</div>
<p>vérifient :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> 
    <span class="nb">id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span>
    <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True True True
</pre></div>
</div>
</div>
</div>
<p>Ah ?!! Ca ne correspond pas à ce qui avait été décrit : l’affectation de non-mutable <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> était supposée créer un nouvel espace mémoire pour stocker la valeur pour <code class="docutils literal notranslate"><span class="pre">x</span></code> … ????</p>
<p>Ici l’environnement <em>choisit d’économiser de la place en mémoire</em> en ne dupliquant pas les valeurs non mutables : après affectation de l’une vers l’autre, elles ont la même valeur !<br />
Une seule valeur est stockée et elle est référencée par 2 variables :</p>
<ul class="simple">
<li><p>la valeur non modifiée (à droite de l’affectation) est toujours référencée par “sa” variable</p></li>
<li><p>la valeur modifiée (à gauche de l’affectation) référence aussi cette valeur.</p></li>
</ul>
<p>Cette optimisation, similaire au traitement du cas non mutable, est un peu piégeuse pour la compréhension.<br />
Cependant, elle est sans effet sur les instructions suivantes, comme cet exemple l’illustre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># affectations de non-mutables -- épisode 2</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b=&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pas de nouvel espace mémoire suite à b = a. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b=&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a est modifié donc un nouvel espace mémoire est créé pour a. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a est encore modifié et un nouvel espace mémoire est encore créé.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Un autre choix aurait été possible mais celui-ci est en cohérence avec le premier traitement observé.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s2">&quot;bizarre : a += 1 devrait être effectué en place : cf. plus loin&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b=&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pas de surprise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a= 1 140201721731376
b= 1 140201721731376
pas de nouvel espace mémoire suite à b = a. 

a= 2 140201721731408
b= 1 140201721731376
a est modifié donc un nouvel espace mémoire est créé pour a. 

a= 3 140201721731440
a est encore modifié et un nouvel espace mémoire est encore créé.
Un autre choix aurait été possible mais celui-ci est en cohérence avec le premier traitement observé.

a= 5 140201721731504
a= 6 140201721731536 bizarre : a += 1 devrait être effectué en place : cf. plus loin

a= 3 140201721731440
b= 1 140201721731376
pas de surprise
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="affectation-en-python-complements">
<h3><span class="section-number">6.3.4. </span>Affectation en python : compléments<a class="headerlink" href="#affectation-en-python-complements" title="Permalink to this headline">#</a></h3>
<section id="modification-partielle-vs-modification-complete-d-un-mutable">
<h4>Modification partielle <em>vs.</em> modification complète d’un mutable<a class="headerlink" href="#modification-partielle-vs-modification-complete-d-un-mutable" title="Permalink to this headline">#</a></h4>
<div class="alert alert-block alert-info">
<p>On retiendra que la modification totale d’un objet mutable conduit à la création d’un nouvel emplacement en mémoire.</p>
<p>En revanche, <b>une modification partielle d’un objet mutable provoque un effet de bord</b>.</p>
</div>   <p>Si l’objet est mutable alors sa modification <strong>partielle</strong> :</p>
<ul class="simple">
<li><p>est effectuée “en place”, c-a-d. à l’adresse mémoire occupée par l’objet.</p></li>
<li><p>Cette modification <strong>est visible</strong> “depuis” les autres variables qui référencent (le cas échéant) cet objet.</p></li>
<li><p>C’est un <strong>effet de bord</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># affectation de mutables</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">l</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t = l&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;modification partielle de l&quot;</span><span class="p">)</span>
<span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;modification totale de l&quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;modifications de l par ses méthodes (aspects POO)&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">l</span>
<span class="n">l</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">l</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t = l
[0, 0] 140201804544832
[0, 0] 140201804544832
modification partielle de l
[2, 0] 140201804544832
[2, 0] 140201804544832
modification totale de l
[4, 3] 140201804594176
[2, 0] 140201804544832
modifications de l par ses méthodes (aspects POO)
[3, 4] 140201804594176
[3, 4] 140201804594176
[4, 3] 140201804594176
[4, 3] 140201804594176
[4, 11, 3] 140201804594176
[4, 11, 3] 140201804594176
</pre></div>
</div>
</div>
</div>
</section>
<section id="comment-dupliquer-re-copier-un-objet-mutable-et-obtenir-2-objets-differents-en-memoire">
<h4>Comment dupliquer (re-copier) un objet mutable et obtenir 2 objets différents en mémoire ?<a class="headerlink" href="#comment-dupliquer-re-copier-un-objet-mutable-et-obtenir-2-objets-differents-en-memoire" title="Permalink to this headline">#</a></h4>
<p>Il faut :</p>
<ul class="simple">
<li><p>réaliser une copie avec la fonction <code class="docutils literal notranslate"><span class="pre">copy()</span></code> du module <code class="docutils literal notranslate"><span class="pre">copy</span></code></p></li>
<li><p>modifier <em>l’ensemble</em> de l’objet :</p>
<ul>
<li><p>en créant des tranches complètes de listes : <code class="docutils literal notranslate"><span class="pre">m[:]</span> <span class="pre">=</span> <span class="pre">l</span></code> ou <code class="docutils literal notranslate"><span class="pre">m[0,len(l)]</span> <span class="pre">=</span> <span class="pre">l</span></code></p></li>
</ul>
</li>
</ul>
<p>La duplication est motivée pour distinguer des traitements différents de l’un ou de l’autre objet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="c1"># affectations et modifications d&#39;objets mutables</span>
<span class="c1"># une liste est mutable</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># initialisation par référence -&gt; pas de duplication</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;par référence&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot; == m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># la modification (partielle) de l impacte aussi m</span>
<span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot; == m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># la modification complète de l n&#39;impacte pas m</span>
<span class="c1"># rmq: c&#39;est une initialisation qui créé un nouvel emplacement mémoire</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot; =/ m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>


<span class="c1"># affectation avec copie explicite </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;par copie&quot;</span><span class="p">)</span>
<span class="c1"># par tranches complètes</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span>
<span class="n">mm</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:]</span>

<span class="c1"># par copy</span>
<span class="n">m_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="s2">&quot;== m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s2">&quot; == mm=&quot;</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="s2">&quot; == m_copy=&quot;</span><span class="p">,</span><span class="n">m_copy</span><span class="p">)</span>

<span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span><span class="s2">&quot;=/ m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s2">&quot; == mm=&quot;</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="s2">&quot; == m_copy=&quot;</span><span class="p">,</span><span class="n">m_copy</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;=/ m=&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s2">&quot; == mm=&quot;</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="s2">&quot; == m_copy=&quot;</span><span class="p">,</span><span class="n">m_copy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>par référence
l= [1, 2, 3]  == m= [1, 2, 3]
l= [5, 2, 3]  == m= [5, 2, 3]
l= [5, 2, 3]  =/ m= [5, 5, 5]
par copie
l= [5, 2, 3] == m= [5, 2, 3]  == mm= [5, 2, 3]  == m_copy= [5, 2, 3]
l= [0, 2, 3] =/ m= [5, 2, 3]  == mm= [5, 2, 3]  == m_copy= [5, 2, 3]
l= [0, 0, 0] =/ m= [5, 2, 3]  == mm= [5, 2, 3]  == m_copy= [5, 2, 3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># les strings sont non-mutables</span>
<span class="c1"># les lists sont mutables</span>

<span class="n">un_dalton</span> <span class="o">=</span> <span class="s2">&quot;Jo&quot;</span> <span class="c1">#string</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">),</span> <span class="n">un_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">les_dalton</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#list</span>
<span class="n">les_dalton</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">),</span> <span class="n">les_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">les_dalton</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;affectation par référence (pas de duplication)&quot;</span><span class="p">)</span>
<span class="n">les_freres_dalton</span> <span class="o">=</span> <span class="n">les_dalton</span> <span class="c1">#affectation par reference (pas de duplication)</span>
<span class="n">les_freres_dalton</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Jack&#39;</span><span class="p">)</span>
<span class="n">un_dalton</span> <span class="o">=</span> <span class="s1">&#39;Averell&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">),</span> <span class="n">les_dalton</span><span class="p">)</span>
<span class="c1">#print(id(les_dalton[0]), les_dalton[0])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_freres_dalton</span><span class="p">),</span> <span class="n">les_freres_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">),</span> <span class="n">un_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">un_dalton</span><span class="p">,</span> <span class="n">les_dalton</span><span class="p">,</span> <span class="n">les_freres_dalton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>140201804542576 Jo

140201804592960 [&#39;Jo&#39;]
140201804542576 Jo

affectation par référence (pas de duplication)
140201804592960 [&#39;Jo&#39;, &#39;Jack&#39;]
140201804592960 [&#39;Jo&#39;, &#39;Jack&#39;]
140201804560560 Averell

Averell [&#39;Jo&#39;, &#39;Jack&#39;] [&#39;Jo&#39;, &#39;Jack&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">un_dalton</span> <span class="o">=</span> <span class="s2">&quot;Jo&quot;</span> <span class="c1">#string</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">),</span> <span class="n">un_dalton</span><span class="p">)</span>
<span class="n">les_dalton</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1">#list</span>
<span class="n">les_dalton</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">)</span>  <span class="c1"># rmq : modification SANS d&#39;affectation</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">),</span> <span class="n">les_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">les_dalton</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;affectation avec duplication&quot;</span><span class="p">)</span>
<span class="n">les_freres_dalton</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">les_dalton</span> <span class="c1"># [:] permet de dupliquer !</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">),</span> <span class="n">les_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_freres_dalton</span><span class="p">),</span> <span class="n">les_freres_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">les_freres_dalton</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Jack&#39;</span><span class="p">)</span>
<span class="n">un_dalton</span> <span class="o">=</span> <span class="s2">&quot;Averell&quot;</span>
<span class="n">les_dalton</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">un_dalton</span><span class="p">)</span> <span class="c1"># rmq : modification SANS d&#39;affectation</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_dalton</span><span class="p">),</span> <span class="n">les_dalton</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">les_freres_dalton</span><span class="p">),</span> <span class="n">les_freres_dalton</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">un_dalton</span><span class="p">,</span> <span class="n">les_dalton</span><span class="p">,</span> <span class="n">les_freres_dalton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>140201804542576 Jo
140201804544832 [&#39;Jo&#39;]
140201804542576 Jo

affectation avec duplication
140201804544832 [&#39;Jo&#39;]
140201804592960 [&#39;Jo&#39;]

140201804544832 [&#39;Jo&#39;, &#39;Averell&#39;]
140201804592960 [&#39;Jo&#39;, &#39;Jack&#39;]
Averell [&#39;Jo&#39;, &#39;Averell&#39;] [&#39;Jo&#39;, &#39;Jack&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="des-subtilites-pour-x-1-vs-x-x-1">
<h4>Des subtilités pour <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+=</span> <span class="pre">1</span></code> <em>vs.</em> <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">1</span></code><a class="headerlink" href="#des-subtilites-pour-x-1-vs-x-x-1" title="Permalink to this headline">#</a></h4>
<p>La composition d’une affectation et d’un opérateur binaire (ici celui associé au symbole ‘+’)  est appelé une <em>affectation augmentée</em>.</p>
<p>Le <a class="reference external" href="https://docs.python.org/fr/3/reference/simple_stmts.html#index-6">manuel de référence du python3</a> indique en <strong>section 7.2.1</strong> :</p>
<blockquote>
<div><p>An augmented assignment expression like x += 1 can be rewritten as x = x + 1 to achieve a <strong>similar, but not exactly equal effect</strong>. In the augmented version, x is only evaluated once. Also, when possible, the actual operation is performed <strong>in-place</strong>, meaning that rather than creating a new object and assigning that to the target, the old object is modified instead.</p>
</div></blockquote>
<p>Nous n’avons pourtant pas pu constater cette modification en place pour <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">1</span></code>  dans l’exemple plus haut.
Mystère ?</p>
<p>L’exemple suivant montre encore que le caractère mutable ou non d’une variable modifie tout ce qui comporte une affectation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a et b non mutables</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">11</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="c1"># a et b mutables</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="n">a</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>140201721731344 140201721731696
140201721731376 140201721731728
140201803337664 140201804544512
140201803337664 140201803295808
</pre></div>
</div>
</div>
</div>
<p>L’affectation augmentée de la liste (mutable) <code class="docutils literal notranslate"><span class="pre">a</span></code> est bien effectuée en place.
Le traitement sur la liste <code class="docutils literal notranslate"><span class="pre">b</span></code>, “similaire mais pas exactement égal” (!) utilise un nouvel espace de stockage pour la nouvelle valeur de <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>Ces traitements sont “exactement égaux” (!) lorsqu’ils sont appliqués à des entiers (non mutables) : création d’un nouvel espace de stockage.</p>
<p>Et tout ceci est bien cohérent si on relit <strong>bien</strong> ce qu’indique le manuel :</p>
<blockquote>
<div><p><em>Also, <strong>when possible</strong>, the actual operation is performed in-place, …</em></p>
</div></blockquote>
<p>Comme nous l’avons rappelé en Section 1.3.2, la modification d’une variable <em>non mutable</em> implique la création d’un nouvel emplacement mémoire, <em>i.e.</em> d’une nouvelle variable mais de même identifiant. Ce qui n’est pas le cas pour une modification partielle d’une variable mutable.</p>
<p><strong>(<span class="math notranslate nohighlight">\(\star)\)</span> Rmq.</strong> Il faudrait aller encore un peu plus loin dans l’analyse de l’affectation augmentée.</p>
<p>En effet, que penser de <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+=</span> <span class="pre">f(x)</span></code> où <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> lui-même peut modifier <code class="docutils literal notranslate"><span class="pre">x</span></code>, voire même le modifier avec une affectation augmentée ?</p>
<p>Les exemples suivants illustrent différents cas de ce type. Attendre la section 1.4 suivante qui clarifie le passage de paramètres selon le caractère mutable ou non de l’argument avant de les regarder plus en détail.</p>
<p>On retiendra surtout cet extrait de la documentation python (version française, section 1.7.2) :</p>
<blockquote>
<div><p>Au contraire des assignations normales, les assignations augmentées <strong>évaluent la partie gauche avant d’évaluer la partie droite</strong>. Par exemple, a[i] += f(x) commence par s’intéresser à a[i], puis Python évalue f(x), effectue l’addition et, enfin, écrit le résultat dans a[i].</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span> <span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;t en modifié localement mais pas &quot;returné&quot;&#39;&#39;&#39;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id dans f -- t:&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s2">&quot;, u: &quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">a</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="n">l</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 140201721731408
id dans f -- t: 140201721731472 , u:  140201721731408
4 140201721731472
[10] 140201803337664
id dans f -- t: 140201804582208 , u:  140201803337664
[10, 10] 140201803337664
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span> <span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;t en modifié localement et renvoyé&#39;&#39;&#39;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id dans f -- t:&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s2">&quot;, u: &quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">a</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="n">l</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 140201721731408
id dans f -- t: 140201721731472 , u:  140201721731408
6 140201721731536
[10] 140201804506880
id dans f -- t: 140201803295488 , u:  140201804506880
[10, 10, 10] 140201804506880
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="star-fonctions-aspects-avances">
<h2><span class="section-number">6.4. </span>(<span class="math notranslate nohighlight">\(\star\)</span>) Fonctions : aspects avancés<a class="headerlink" href="#star-fonctions-aspects-avances" title="Permalink to this headline">#</a></h2>
<div class="alert alert-block alert-success">
    Cette section relève de <b>l'objectif 20</b>
</div><p>Nous allons étudier plus en détail le passage des paramètres de fonction en python.</p>
<p>On a écrit :</p>
<blockquote>
<div><p>python : passage <span class="math notranslate nohighlight">\(\Leftrightarrow\)</span> <strong>affectation</strong></p>
</div></blockquote>
<p>En effet, le passage de paramètre correspond à l’affectation :</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">paramètre</span> <span class="pre">formel</span> <span class="pre">=</span> <span class="pre">paramètre</span> <span class="pre">effectif</span></code></p>
</div></blockquote>
<p>On a détaillé que le mécanisme de ce type d’affectation (copie vs. référence) dépendait du caratère mutable (référence) ou non-mutable (copie) des objets.</p>
<p><strong>Rappel</strong></p>
<p>Le <a class="reference external" href="https://docs.python.org/fr/3/tutorial/controlflow.html#id2">tutoriel python.org</a> dit :</p>
<blockquote>
<div><p>Les paramètres effectifs (arguments) d’une fonction sont introduits dans la table de symboles locale de la fonction appelée lorsqu’elle est appelée ; par conséquent, <strong>les passages de paramètres</strong> se font par valeur, la valeur étant toujours une <strong>référence à un objet</strong>, et non la valeur de l’objet lui-même.</p>
</div></blockquote>
<p>Ce traitement est similaire à celui de l’<em>affectation</em> en python décrit
<a class="reference external" href="#revisiter_les_variables_et_l_%27_affectation">plus haut</a>.
Ce qui donne les 2 cas suivants.</p>
<section id="le-parametre-est-de-type-non-mutable">
<h3><span class="section-number">6.4.1. </span>Le paramètre est de type non-mutable<a class="headerlink" href="#le-parametre-est-de-type-non-mutable" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>transmission de la <em>valeur</em> de l’argument effectif</p></li>
<li><p>argument formel <em>similaire à</em> une variable locale de la fonction</p></li>
<li><p>à l’extérieur de la fonction : pas de modification de la variable passée en argument</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonctions et paramètres de type non-mutable</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;retourne une variable locale&#39;&#39;&#39;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> 
    <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;retourne le paramètre formel modifié&#39;&#39;&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant les appels:&quot;</span><span class="p">,</span> <span class="s2">&quot;u=&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span> <span class="s2">&quot;, y=&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(u)=&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;g(y)=&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;après les appels:&quot;</span><span class="p">,</span> <span class="s2">&quot;u=&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span> <span class="s2">&quot;, y=&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant les appels: u= 0 , y= 0.0

f(u)= 1
g(y)= 1.0

après les appels: u= 0 , y= 0.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Les valeurs de <code class="docutils literal notranslate"><span class="pre">u</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> sont bien inchangées dans l’appelant bien que <code class="docutils literal notranslate"><span class="pre">y</span></code> soit un paramètre d’entrée modifié et retourné dans <code class="docutils literal notranslate"><span class="pre">g</span></code>.  Il faut voir ces paramètres formels comme des variables locales.</p></li>
<li><p>Bien sûr, il manque dans l’appelant une affectation du retour de la fonction.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
1.0
False
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Attention au <code class="docutils literal notranslate"><span class="pre">print(appel</span> <span class="pre">de</span> <span class="pre">f)</span></code> !</strong></p></li>
</ul>
<p><strong>Exercice</strong>. Expliquer pourquoi c’est normal !</p>
</section>
<section id="le-parametre-de-type-mutable">
<h3><span class="section-number">6.4.2. </span>Le paramètre de type mutable<a class="headerlink" href="#le-parametre-de-type-mutable" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>transmission de <em>l’adresse</em> de l’argument effectif</p></li>
<li><p>l’argument effectif est <em>ainsi</em> la variable extérieure à la fonction</p>
<ul>
<li><p>il <em>peut</em> donc y avoir modification de la valeur dans l’appelant de la variable passée en argument même si celle-ci n’est pas retournée par la fonction. C’est un <em>effet de bord.</em></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonction et paramètres de type mutable</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;extension d&#39;une liste avec duplication de ses valeurs</span>
<span class="sd">    l&#39;utilisation pythonique du symbole * est quand même maladroite pour ce type de traitement</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">l</span>   <span class="c1"># même référence</span>
<span class="c1">#m = []  # création</span>
<span class="n">m</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">l</span> <span class="c1"># duplication </span>
<span class="n">mm</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:]</span> <span class="c1"># création+duplication</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant appel:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>  <span class="s2">&quot;mm=&quot;</span><span class="p">,</span> <span class="n">mm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id : l=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;, ll=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="s2">&quot;, mm=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">mm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation l = f(l):&quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id : l=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;, ll=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant appel:
l= [0, 1] ll= [0, 1] , m= [0, 1] mm= [0, 1]
id : l= 140201804600320 , ll= 140201804600320 , m= 140201804601664 , mm= 140201804505408

appel avec affectation l = f(l):
l= [0, 1, 0, 1] ll= [0, 1] , m= [0, 1]
id : l= 140201804604992 , ll= 140201804600320 , m= 140201804601664
</pre></div>
</div>
</div>
</div>
<p><strong>Exercice</strong></p>
<ol class="simple">
<li><p>Dans le premier appel (avec affectation vers <code class="docutils literal notranslate"><span class="pre">l</span></code>), pourquoi <code class="docutils literal notranslate"><span class="pre">ll</span></code> qui est (était) une référence vers <code class="docutils literal notranslate"><span class="pre">l</span></code> n’est pas modifiée ?</p></li>
</ol>
<p>L’appel avec affectation (dans <code class="docutils literal notranslate"><span class="pre">l</span></code>) n’a pas eu d’effet (de bord) sur l’autre référence (<code class="docutils literal notranslate"><span class="pre">ll</span></code>), ni bien sûr sur les variables dupliquées.
C’est pourtant bien la référence de l’argument effectif qui est connue de l’appel de la fonction.</p>
<p>Ici, la fonction <strong>modifie complètement</strong> ce paramètre mutable. Une nouvelle variable locale est donc créée et renvoyée. L’affectation (même dans la variable fournie comme argument d’entrée) effectue la mise à jour de la variable affectée.</p>
<p><strong>Attention</strong></p>
<p>Les écritures approximatives de fonction (sans <code class="docutils literal notranslate"><span class="pre">return</span></code>) ou les appels sans affectation du résultat (à la procédure) peuvent être dangereux.</p>
<p><strong>pythontutor.</strong> <a class="reference external" href="http://pythontutor.com/visualize.html#code=%23%20fonctions%20sans%20annotation%20de%20type%20pour%20l%27exemple%0Adef%20f%28x%29%20%3A%0A%20%20%20%20x%20%3D%20x%20*%202%0A%20%20%20%20return%20x%0A%0Adef%20g%28x%29%20%3A%0A%20%20%20%20x%20%3D%20x%20*%202%0A%0Adef%20h%28x%29%3A%0A%20%20%20%20x%5B0%5D%20%3D%20777%0A%20%20%20%20%20%20%20%20%0Au%20%3D%203%0At%20%3D%20%5B1,%202%5D%0A%0A%23%20appel%20f%20%28modification%20complete%20avec%20return%29%20sans%20affectation%0Af%28u%29%0Af%28t%29%0A%0A%23%20appel%20g%20%28sans%20return%20explicite%29%20et%20sans%20affectation%0Ag%28u%29%0Ag%28t%29%0A%0A%23%20appel%20h%20%28modification%20partielle%29%20sans%20affectation%0Ah%28t%29&amp;cumulative=false&amp;heapPrimitives=nevernest&amp;mode=edit&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false">L’exécution suivante</a>
est une fois de plus instructive.</p>
<p>Un comportement similaire est obtenu lorsque la fonction manipule un paramètre objet par ses méthodes. L’exemple suivant illustre ce cas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># procedure : methode et paramètres de type mutable</span>
<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;appel d&#39;une méthode sur un objet mutable&#39;&#39;&#39;</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#return None</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">l</span>   <span class="c1"># même objet</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:]</span> <span class="c1"># duplication</span>

<span class="c1">#observons</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l, ll, m&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel sans affectation du retour: g(l)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;print g(l)=&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;, id=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation: l = g(l)&quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;, id=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation m = g(l):&quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;id=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;, id=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l, ll, m
[0, 0] &lt;class &#39;list&#39;&gt; 140201804763456
[0, 0] &lt;class &#39;list&#39;&gt; 140201804763456
[0, 0] &lt;class &#39;list&#39;&gt; 140201804763392

appel sans affectation du retour: g(l)
print g(l)= None
l= [0, 0, 1] ll= [0, 0, 1] , m= [0, 0]
id= 140201804763456 id= 140201804763456 , id= 140201804763392

appel avec affectation: l = g(l)
l= None ll= [0, 0, 1, 1] , m= [0, 0]
id= 4306165552 id= 140201804763456 , id= 140201804763392

appel avec affectation m = g(l):
l= [0, 0, 1] ll= [0, 0, 1, 1] , m= None
id= 140201804601664 id= 140201804763456 , id= 4306165552
</pre></div>
</div>
</div>
</div>
<p>ATTENTION : c’est bien piégeux !</p>
<p>Retenons pour l’instant, c-a-d. tant qu’on ne manipule pas d’objet.</p>
<ul class="simple">
<li><p>Le passage de paramètre s’effectue :</p>
<ul>
<li><p>par valeur pour des non-mutables</p></li>
<li><p>par adresse  pour des mutables,</p></li>
</ul>
</li>
<li><p>et ce conformément aux mécanismes d’affectation :</p>
<ul>
<li><p>copie pour des non-mutables</p></li>
<li><p>référence pour des mutables.</p></li>
</ul>
</li>
<li><p>Les paramètres formels sont équivalents à des variables locales.</p></li>
<li><p>L’affectation avec <code class="docutils literal notranslate"><span class="pre">return</span></code> <strong>doit</strong> (devrait) être le seul effet dans l’appelant.</p></li>
</ul>
<div class="alert alert-danger">
<p><b>Attention</b> aux modifications partielles de paramètres effectifs mutables.</p>
</div><p><strong>Rmq.</strong> Sur ce point, on trouve de tout sur internet et même les ouvrages (dont certains sont dispos à la BU). J’ai lu :</p>
<ul class="simple">
<li><p>c’est du passage par référence</p></li>
<li><p>c’est du passage par valeur</p></li>
<li><p>c’est un mélange des 2</p></li>
<li><p>c’est aucun des deux …</p></li>
</ul>
<p><strong>Exemple.</strong> Retour sur une fonction de permutation de 2 entiers … ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">11</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant : a,b =&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">t</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;après : a,b =&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">permuter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39; attention : </span>
<span class="sd">    les print dans cette fonction sont uniquement à but pédagogique</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dans permuter, avant x,y :&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dans permuter, après x,y :&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1">#return x, y</span>
    
<span class="c1"># marche pas !</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">11</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant fonction : a,b =&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">permuter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;après fonction : a,b =&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant : a,b = 1 11
après : a,b = 11 1
avant fonction : a,b = 1 11
dans permuter, avant x,y : 1 11
dans permuter, après x,y : 11 1
après fonction : a,b = 1 11
</pre></div>
</div>
</div>
</div>
</section>
<section id="optionnel-avoir-les-id-claires">
<h3><span class="section-number">6.4.3. </span>(Optionnel) Avoir les <code class="docutils literal notranslate"><span class="pre">id</span> </code> claires !<a class="headerlink" href="#optionnel-avoir-les-id-claires" title="Permalink to this headline">#</a></h3>
<p>Reprenons les observations précédentes effectuées grâce à pythontutor avec un focus particulier sur cette fonction <code class="docutils literal notranslate"><span class="pre">id()</span></code>.
Cette fonction peut être très utile pour <em>debugger</em> un développement qui ne fonctionne pas correctement.</p>
<section id="utilisons-les-id-avec-les-mutables">
<h4>Utilisons les <code class="docutils literal notranslate"><span class="pre">id()</span></code> avec les mutables<a class="headerlink" href="#utilisons-les-id-avec-les-mutables" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonction et paramètres de type mutable</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f avant : @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f après : @= &quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">l</span>   <span class="c1"># même référence</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:]</span> <span class="c1"># duplication</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant les appels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;@l=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;@ll=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;@m=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel sans affectation du retour:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main: @l=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;print f(l)=&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;@f(l)=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;@l=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;@ll=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;@m=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation l = f(l):&quot;</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main: @l(après l=f(l))=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l=&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="s2">&quot;ll=&quot;</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span> <span class="s2">&quot;, m=&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;@l=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s2">&quot;@ll=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span> <span class="s2">&quot;@m=&quot;</span><span class="p">,</span><span class="nb">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant les appels:
l= [0, 0] ll= [0, 0] m= [0, 0]
@l= 140201804758016 @ll= 140201804758016 @m= 140201804757440

appel sans affectation du retour:
main: @l= 140201804758016
  f avant : @= 140201804758016
  f après : @=  140201804508032
  f avant : @= 140201804758016
  f après : @=  140201804599488
print f(l)= [0, 0, 0, 0] @f(l)= 140201804599488
l= [0, 0] ll= [0, 0] , m= [0, 0]
@l= 140201804758016 @ll= 140201804758016 @m= 140201804757440

appel avec affectation l = f(l):
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  f avant : @= 140201804758016
  f après : @=  140201804605504
main: @l(après l=f(l))= 140201804605504
l= [0, 0, 0, 0] ll= [0, 0] , m= [0, 0]
@l= 140201804605504 @ll= 140201804758016 @m= 140201804757440
</pre></div>
</div>
</div>
</div>
</section>
<section id="utilisons-les-id-avec-les-non-mutables">
<h4>Utilisons les <code class="docutils literal notranslate"><span class="pre">id()</span></code> avec les non mutables<a class="headerlink" href="#utilisons-les-id-avec-les-non-mutables" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonctions et paramètres de type non-mutable</span>
<span class="c1"># f avec variable intermédiaire explicite</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_r: avant @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_r: après @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_x: avant @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_x: après @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_=: avant @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_=: après @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant les appels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel sans affectation du retour:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(u)=&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="s2">&quot;@f(u)=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation du retour:&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u après u=f(u)=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant les appels:
u= 0 @u= 140201721731344

appel sans affectation du retour:
  f_r: avant @= 140201721731344
  f_r: après @= 140201721731344
  f_r: avant @= 140201721731344
  f_r: après @= 140201721731344
f(u)= 2 @f(u)= 140201721731408
u= 0 @u= 140201721731344

appel avec affectation du retour:
  f_r: avant @= 140201721731344
  f_r: après @= 140201721731344
u après u=f(u)= 2 @u= 140201721731408
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonctions et paramètres de type non-mutable</span>
<span class="c1"># f sans variable locale explicite</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_x: avant @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_x: après @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant les appels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel sans affectation du retour:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(u)=&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="s2">&quot;@f(u)=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation du retour:&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u après u=f(u)=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant les appels:
u= 1 @u= 140201721731376

appel sans affectation du retour:
  f_x: avant @= 140201721731376
  f_x: après @= 140201721731440
  f_x: avant @= 140201721731376
  f_x: après @= 140201721731440
f(u)= 3 @f(u)= 140201721731440
u= 1 @u= 140201721731376

appel avec affectation du retour:
  f_x: avant @= 140201721731376
  f_x: après @= 140201721731440
u après u=f(u)= 3 @u= 140201721731440
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fonctions et paramètres de type non-mutable</span>
<span class="c1"># f avec affectation composée</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_=: avant @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  f_=: après @=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;avant les appels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel sans affectation du retour:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(u)=&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="s2">&quot;@f(u)=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;appel avec affectation du retour:&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u après u=f(u)=&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;@u=&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avant les appels:
u= 0 @u= 140201721731344

appel sans affectation du retour:
  f_=: avant @= 140201721731344
  f_=: après @= 140201721731408
  f_=: avant @= 140201721731344
  f_=: après @= 140201721731408
f(u)= 2 @f(u)= 140201721731408
u= 0 @u= 140201721731344

appel avec affectation du retour:
  f_=: avant @= 140201721731344
  f_=: après @= 140201721731408
u après u=f(u)= 2 @u= 140201721731408
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="les-fonctions-en-python-derniers-complements-faciles">
<h2><span class="section-number">6.5. </span>Les fonctions en python : derniers compléments faciles<a class="headerlink" href="#les-fonctions-en-python-derniers-complements-faciles" title="Permalink to this headline">#</a></h2>
<p>Deux compléments faciles (arguments nommés et argument avec valeur par défaut) ainsi qu’une courte liste de ce qu’il reste à découvrir … pour les plus curieux.</p>
<section id="arguments-nommes">
<h3><span class="section-number">6.5.1. </span>Arguments nommés<a class="headerlink" href="#arguments-nommes" title="Permalink to this headline">#</a></h3>
<p>Lors de l’<em>appel</em>, nommer les paramètres <em>formels</em> et la valeur correspondante de l’argument (effectif), permet un ordre quelconque de ceux-ci.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trois_mots</span><span class="p">(</span><span class="n">mot1</span><span class="p">,</span> <span class="n">mot2</span><span class="p">,</span> <span class="n">mot3</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">mot1</span> <span class="o">+</span> <span class="n">mot2</span> <span class="o">+</span> <span class="n">mot3</span>

<span class="n">m1</span> <span class="o">=</span> <span class="s1">&#39;Bonjour &#39;</span>
<span class="n">m2</span> <span class="o">=</span> <span class="s1">&#39;étudiantes et &#39;</span>
<span class="n">m3</span> <span class="o">=</span> <span class="s1">&#39;étudiants !&#39;</span>

<span class="c1">#appel par position</span>
<span class="n">m_classique</span> <span class="o">=</span> <span class="n">trois_mots</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="p">)</span>

<span class="c1"># appel par nom</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">trois_mots</span><span class="p">(</span><span class="n">mot3</span><span class="o">=</span><span class="n">m3</span><span class="p">,</span> <span class="n">mot1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">mot2</span><span class="o">=</span><span class="n">m2</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">m_classique</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bonjour étudiantes et étudiants !
Bonjour étudiantes et étudiants !
</pre></div>
</div>
</div>
</div>
</section>
<section id="argument-avec-valeur-par-defaut">
<h3><span class="section-number">6.5.2. </span>Argument avec valeur par défaut<a class="headerlink" href="#argument-avec-valeur-par-defaut" title="Permalink to this headline">#</a></h3>
<p>Les <em>derniers</em> paramètres formels peuvent bénéficier de valeurs par défaut</p>
<ul class="simple">
<li><p>derniers : tous à partir d’un rang arbitraire</p></li>
<li><p>les précédents sont sans valeur par défaut</p></li>
</ul>
<p>Lors de l’<em>appel</em>, ces valeurs sont utilisées en cas d’absence des paramètres effectifs.</p>
<p>Syntaxe :</p>
<ul class="simple">
<li><p>Ces valeurs sont définies avec une affectation <em>après</em> l’annotation de type.</p></li>
<li><p>L’annotation raccourcie de types (une annotation commune à tous les paramètres)  ne peuvent être utilisées en cas d’argument avec valeur par défaut.</p></li>
</ul>
<div class="alert alert-block alert-warning">
<p>En pratique, limiter les valeurs par défaut à des paramètres <em>non-mutables</em> : <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>,  <code class="docutils literal notranslate"><span class="pre">tuple</span></code></p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">incrementer</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">tournure_polie</span><span class="p">(</span><span class="n">mot1</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mot2</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; Madame, &quot;</span><span class="p">,</span> <span class="n">mot3</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Monsieur.&quot;</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">mot1</span> <span class="o">+</span> <span class="n">mot2</span> <span class="o">+</span> <span class="n">mot3</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">incrementer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">incrementer</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">incrementer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tournure_polie</span><span class="p">(</span><span class="s1">&#39;Bonjour&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tournure_polie</span><span class="p">(</span><span class="s1">&#39;Au revoir&#39;</span><span class="p">,</span> <span class="s1">&#39; très cher &#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tournure_polie</span><span class="p">(</span><span class="s1">&#39;Au revoir&#39;</span><span class="p">,</span> <span class="n">mot3</span> <span class="o">=</span><span class="s1">&#39;et très cher Monsieur&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tournure_polie</span><span class="p">(</span><span class="s1">&#39;Au revoir &#39;</span><span class="p">,</span> <span class="s2">&quot;les uns,&quot;</span><span class="p">,</span> <span class="s1">&#39; et les autres.&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a= 0
a= 1
2
8
Bonjour Madame, Monsieur.
Au revoir très cher Monsieur.
Au revoir Madame, et très cher Monsieur
Au revoir les uns, et les autres.
</pre></div>
</div>
</div>
</div>
</section>
<section id="ce-qu-il-reste-a-voir-sur-les-fonctions-en-python">
<h3><span class="section-number">6.5.3. </span>Ce qu’il reste à voir sur les fonctions en python<a class="headerlink" href="#ce-qu-il-reste-a-voir-sur-les-fonctions-en-python" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Argument de type fonction</p></li>
<li><p>Nombre variable d’arguments (tuple et dictionnaire)</p></li>
<li><p>Fonction comme valeur de première classe : <code class="docutils literal notranslate"><span class="pre">lambda</span></code> fonction</p></li>
</ul>
</section>
</section>
<section id="synthese">
<h2><span class="section-number">6.6. </span>Synthèse<a class="headerlink" href="#synthese" title="Permalink to this headline">#</a></h2>
<section id="avoir-les-idees-claires">
<h3><span class="section-number">6.6.1. </span>Avoir les idées claires<a class="headerlink" href="#avoir-les-idees-claires" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Les principes du passage de paramètres appelant &lt;-&gt; appelé</p>
<ul>
<li><p>“matériel” : par valeur <em>vs.</em> par adresse</p></li>
<li><p>logique : in <em>vs.</em> out <em>vs.</em> inout</p></li>
<li><p>aide : différencier fonction <em>vs.</em> procédure</p></li>
</ul>
</li>
<li><p>L’effet de bord est néfaste</p>
<ul>
<li><p>possible pour le passage par adresse, et les variables globales (à proscrire)</p></li>
</ul>
</li>
<li><p>L’affectation et le passage de paramètres <strong>en python</strong></p>
<ul>
<li><p>pas de surprise pour les non-mutables (= variables locales)</p></li>
<li><p><strong>attention aux mutables</strong> : danger d’effet de bord <em>si modification partielle</em></p></li>
<li><p>ne pas prendre de risque : <code class="docutils literal notranslate"><span class="pre">return</span></code> dans la fonction et affectation dans l’appelant</p></li>
</ul>
</li>
</ul>
</section>
<section id="savoir-faire-en-python">
<h3><span class="section-number">6.6.2. </span>Savoir-faire en python<a class="headerlink" href="#savoir-faire-en-python" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Fonctions avec arguments nommés, avec paramètres par défaut.</p></li>
</ul>
<p><strong>Objectif 20</strong></p>
<ul class="simple">
<li><p>Affectation en python</p>
<ul>
<li><p>non-mutables : (référence à) la valeur</p></li>
<li><p>mutables : (référence à) l’adresse</p></li>
<li><p>attention aux mutables  :
modification partielles <em>vs.</em> duplication (par <code class="docutils literal notranslate"><span class="pre">copy.copy</span></code> ou par “tranches complètes”)</p></li>
<li><p>penser “objet” aide pour le comportement des mutables</p></li>
</ul>
</li>
<li><p>Fonction et passage d’argument appelant/appelé en python :</p>
<ul>
<li><p>similaire à l’affectation : distinguer mutable <em>vs.</em> non mutable</p></li>
</ul>
</li>
<li><p>Savoir effectuer des introspections (fonction <code class="docutils literal notranslate"><span class="pre">id()</span></code>)</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./cm"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="5-types_composes.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Les types composés</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="9-ES-avancees.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Les entrées-sorties (E/S) : aspects avancés</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ph. Langlois<br/>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>